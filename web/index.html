<!DOCTYPE html>
<html lang="en" data-theme="blue-light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="R-Service Tracker - Premium job tracking and payment management system">
    <meta name="keywords" content="job tracker, payment tracker, work tracker, R-Service">
    <meta name="author" content="R-Service">
    <title>R-Service Tracker</title>
    
    <!-- Favicon - Comprehensive Support -->
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
    <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
    <link rel="apple-touch-icon" sizes="192x192" href="assets/icon-192.png">
    <link rel="apple-touch-icon" sizes="512x512" href="assets/icon-512.png">
    <link rel="shortcut icon" href="assets/favicon.ico">
    <meta name="msapplication-TileImage" content="assets/icon-192.png">
    <meta name="msapplication-TileColor" content="#2196F3">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2196F3" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#000000" media="(prefers-color-scheme: dark)">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="R-Service Tracker">
    <meta name="msapplication-TileColor" content="#2196F3">
    <meta name="msapplication-navbutton-color" content="#2196F3">
    <meta name="application-name" content="R-Service Tracker">
    
    <!-- Additional PWA and browser optimizations -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="format-detection" content="telephone=no">
    
    <!-- Google Fonts (optimized loading) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Exo:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
    <noscript><link href="https://fonts.googleapis.com/css2?family=Exo:wght@300;400;500;600;700;800&display=swap" rel="stylesheet"></noscript>
    
    <!-- Font Awesome (optimized loading) -->
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"></noscript>
    
    <!-- Chart.js (defer for better performance) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>
    
    <!-- jsPDF (defer for better performance) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" defer></script>
    
    <!-- CSS -->
    <link rel="stylesheet" href="css/style.css">
    
    <!-- Constants -->
    <script src="js/constants.js" defer></script>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-logo">
                <i class="fas fa-check-circle"></i>
            </div>
            <div class="loading-text">R-Service Tracker</div>
            <div class="loading-spinner">
                <div class="spinner"></div>
            </div>
            <div class="loading-subtitle">Daily Work Tracker</div>
        </div>
    </div>

    <!-- Main Container -->
    <div id="mainContainer" class="main-container" style="display: none;">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-check-circle"></i>
                    <span class="logo-text"><span class="logo-part">R-Service</span><span class="logo-part"> Tracker</span></span>
                </div>
                <div class="header-actions">
                    <button id="menuToggle" class="menu-toggle">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Side Menu -->
        <div id="sideMenu" class="side-menu">
            <div class="menu-header">
                <h3>Settings</h3>
                <button id="closeMenu" class="close-menu">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="menu-content">
                <!-- Theme Section -->
                <div class="menu-section">
                    <h4><i class="fas fa-palette"></i> Theme</h4>
                    
                    <!-- Main Colors -->
                    <div class="theme-subsection">
                        <h5>Main Color</h5>
                        <div class="color-options">
                            <button class="color-btn active" data-color="blue">
                                <span class="color-circle blue"></span>
                                Blue
                            </button>
                            <button class="color-btn" data-color="orange">
                                <span class="color-circle orange"></span>
                                Orange
                            </button>
                            <button class="color-btn" data-color="green">
                                <span class="color-circle green"></span>
                                Green
                            </button>
                            <button class="color-btn" data-color="red">
                                <span class="color-circle red"></span>
                                Red
                            </button>
                            <button class="color-btn" data-color="monochrome">
                                <span class="color-circle monochrome"></span>
                                B&W
                            </button>
                        </div>
                    </div>

                    <!-- Theme Mode -->
                    <div class="theme-subsection">
                        <h5>Theme Mode</h5>
                        <div class="mode-options">
                            <button class="mode-btn active" data-mode="light">
                                <i class="fas fa-sun"></i>
                                Light
                            </button>
                            <button class="mode-btn" data-mode="dark">
                                <i class="fas fa-moon"></i>
                                Dark
                            </button>
                        </div>
                    </div>
                </div>

                <!-- History Section -->
                <div class="menu-section">
                    <h4><i class="fas fa-history"></i> History</h4>
                    <button id="viewHistory" class="menu-option">
                        <i class="fas fa-list"></i>
                        View Work History
                    </button>
                    <button id="viewAnalytics" class="menu-option">
                        <i class="fas fa-chart-bar"></i>
                        Analytics
                    </button>
                </div>

                <!-- App Settings Section -->
                <div class="menu-section">
                    <h4><i class="fas fa-cog"></i> App Settings</h4>
                    
                    <div class="settings-group">
                        <label for="incrementValue">
                            <i class="fas fa-plus-circle"></i>
                            Increment Value (₹)
                        </label>
                        <input type="number" id="incrementValue" min="1" max="100" value="25" class="settings-input">
                        <small>Amount increment for payment options</small>
                    </div>
                    
                    <div class="settings-group">
                        <label for="paymentDuration">
                            <i class="fas fa-calendar-days"></i>
                            Payment Day Duration
                        </label>
                        <input type="number" id="paymentDuration" min="1" max="30" value="4" class="settings-input">
                        <small>Days before payment can be collected</small>
                    </div>
                    
                    <div class="settings-group">
                        <label for="maxPaymentAmount">
                            <i class="fas fa-money-bill-wave"></i>
                            Maximum Payment (₹)
                        </label>
                        <input type="number" id="maxPaymentAmount" min="100" max="10000" step="100" value="500" class="settings-input">
                        <small>Maximum amount shown in payment options</small>
                    </div>
                    
                    <div class="settings-actions">
                        <button id="saveSettings" class="menu-option success">
                            <i class="fas fa-save"></i>
                            Save Settings
                        </button>
                        <button id="resetSettings" class="menu-option">
                            <i class="fas fa-undo"></i>
                            Reset to Default
                        </button>
                    </div>
                </div>


                <!-- Data Section -->
                <div class="menu-section">
                    <h4><i class="fas fa-database"></i> Data</h4>
                    <button id="exportPDF" class="menu-option">
                        <i class="fas fa-file-pdf"></i>
                        Export PDF
                    </button>
                    <button id="clearData" class="menu-option danger">
                        <i class="fas fa-trash"></i>
                        Clear All Data
                    </button>
                </div>

                <!-- About Section -->
                <div class="menu-section">
                    <h4><i class="fas fa-info-circle"></i> About</h4>
                    <button id="aboutApp" class="menu-option">
                        <i class="fas fa-question-circle"></i>
                        About Tracker
                    </button>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard -->
            <div id="dashboard" class="dashboard">
                <div class="dashboard-grid">
                    <!-- Current Status Card -->
                    <div class="card status-card">
                        <div class="card-header">
                            <h3><i class="fas fa-calendar-day"></i> Today's Status</h3>
                        </div>
                        <div class="card-content">
                            <div class="status-info">
                                <div class="date-display">
                                    <span id="currentDate"></span>
                                </div>
                                <div class="work-status">
                                    <div id="workStatus" class="status-badge pending">
                                        <i class="fas fa-clock"></i>
                                        Not Started
                                    </div>
                                </div>
                            </div>
                            <div class="action-buttons">
                                <button id="doneBtn" class="btn btn-primary">
                                    <i class="fas fa-check"></i>
                                    Mark as Done
                                </button>
                                <button id="paidBtn" class="btn btn-success enhanced-paid-btn">
                                    <i class="fas fa-money-bill-wave"></i>
                                    Mark as Paid
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Earnings Card -->
                    <div class="card earnings-card">
                        <div class="card-header">
                            <h3><i class="fas fa-coins"></i> Earnings</h3>
                            <button id="earningsInsightBtn" class="earnings-insight-btn" title="View Earnings Insights">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </div>
                        <div class="card-content">
                            <div class="earnings-info">
                                <div class="current-earnings">
                                    <span class="amount">₹<span id="currentEarnings">0</span></span>
                                    <span class="label">Current Balance</span>
                                </div>
                                <div class="days-worked">
                                    <span class="count" id="daysWorked">0</span>
                                    <span class="label">Days Worked</span>
                                </div>
                                <div class="total-earned">
                                    <span class="amount">₹<span id="totalEarned">0</span></span>
                                    <span class="label">Total Earned</span>
                                </div>
                            </div>
                            <div class="progress-section">
                                <div class="progress-label">
                                    <span id="progressLabel">Progress to Payday</span>
                                    <span id="progressText">0/4 days</span>
                                </div>
                                <div class="progress-bar">
                                    <div id="progressFill" class="progress-fill" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions Card -->
                    <div class="card actions-card">
                        <div class="card-header">
                            <h3><i class="fas fa-bolt"></i> Quick Actions</h3>
                        </div>
                        <div class="card-content">
                            <div class="quick-actions">
                                <button id="viewBalanceSheet" class="action-btn">
                                    <i class="fas fa-table"></i>
                                    <span>Balance Sheet</span>
                                </button>
                                <button id="viewCalendar" class="action-btn">
                                    <i class="fas fa-calendar-alt"></i>
                                    <span>Calendar</span>
                                </button>
                                <button id="viewCharts" class="action-btn">
                                    <i class="fas fa-chart-line"></i>
                                    <span>Analytics</span>
                                </button>
                                <button id="dailyStreak" class="action-btn">
                                    <i class="fas fa-fire"></i>
                                    <span>Streak: <span id="streakCount">0</span></span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Balance Sheet View -->
            <div id="balanceSheetView" class="view-section" style="display: none;">
                <div class="view-header">
                    <h2><i class="fas fa-table"></i> Balance Sheet</h2>
                    <button id="closeBalanceSheet" class="btn btn-secondary">
                        <i class="fas fa-times"></i> Close
                    </button>
                </div>
                <div class="balance-sheet-content">
                    <div class="sheet-filters">
                        <select id="monthFilter">
                            <option value="all">All Months</option>
                        </select>
                        <select id="yearFilter">
                            <option value="all">All Years</option>
                        </select>
                    </div>
                    <div id="balanceSheetTable" class="balance-sheet-table"></div>
                </div>
            </div>

            <!-- Analytics View -->
            <div id="analyticsView" class="view-section" style="display: none;">
                <div class="view-header">
                    <h2><i class="fas fa-chart-bar"></i> Analytics</h2>
                    <button id="closeAnalytics" class="btn btn-secondary">
                        <i class="fas fa-times"></i> Close
                    </button>
                </div>
                <div class="analytics-content">
                    <div class="charts-grid">
                        <div class="chart-container">
                            <canvas id="earningsChart"></canvas>
                        </div>
                        <div class="chart-container">
                            <canvas id="workDaysChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Calendar View -->
            <div id="calendarView" class="view-section" style="display: none;">
                <div class="view-header">
                    <h2><i class="fas fa-calendar-alt"></i> Calendar</h2>
                    <button id="closeCalendar" class="btn btn-secondary">
                        <i class="fas fa-times"></i> Close
                    </button>
                </div>
                <div class="calendar-content">
                    <div class="calendar-controls">
                        <button id="prevMonth" class="btn btn-secondary">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <h3 id="calendarTitle"></h3>
                        <button id="nextMonth" class="btn btn-secondary">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                    <div class="calendar-container">
                        <div id="calendarGrid" class="calendar-grid"></div>
                    </div>
                </div>
            </div>
        </main>
        
        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <p>© R-Service <span id="currentYear">2025</span> • All rights reserved ❤️</p>
            </div>
        </footer>
    </div>

    <!-- Modals -->
    <div id="aboutModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>About Tracker</h3>
                <button class="close-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="about-content">
                    <div class="app-info">
                        <div class="app-title">
                            <i class="fas fa-check-circle app-icon"></i>
                            <h4>Tracker</h4>
                        </div>
                        <p class="app-description">Professional work tracking and payment management system with advanced features for freelancers and contractors.</p>
                    </div>
                    
                    <div class="features-compact">
                        <div class="feature-highlight">
                            <i class="fas fa-briefcase"></i>
                            <span>Daily Work Tracking</span>
                        </div>
                        <div class="feature-highlight">
                            <i class="fas fa-money-bill-wave"></i>
                            <span>Advanced Payment System</span>
                        </div>
                        <div class="feature-highlight">
                            <i class="fas fa-chart-line"></i>
                            <span>Analytics & PDF Reports</span>
                        </div>
                        <div class="feature-highlight">
                            <i class="fas fa-mobile-alt"></i>
                            <span>Offline PWA</span>
                        </div>
                    </div>
                    
                    <div class="privacy-info">
                        <p><i class="fas fa-shield-alt"></i> <strong>Privacy First:</strong> All data stays on your device. No tracking, no ads.</p>
                        <p><i class="fas fa-star"></i> Premium tracking solution for professionals</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="confirmModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Confirm Action</h3>
            </div>
            <div class="modal-body">
                <p id="confirmMessage"></p>
                <div class="modal-actions">
                    <button id="confirmYes" class="btn btn-danger">Yes, Continue</button>
                    <button id="confirmNo" class="btn btn-secondary">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Date Selection Modal -->
    <div id="dateSelectionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Select Payment Date</h3>
                <button class="close-modal" id="closeDateSelectionModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="date-selection-info">
                    <p>Choose when you want to mark the payment:</p>
                </div>
                <div class="date-options">
                    <button id="todayDateBtn" class="btn btn-primary date-option-btn">
                        <i class="fas fa-calendar-day"></i>
                        <div>
                            <strong>Today</strong>
                            <small>Mark payment for today</small>
                        </div>
                    </button>
                    <button id="previousDateBtn" class="btn btn-secondary date-option-btn">
                        <i class="fas fa-calendar-alt"></i>
                        <div>
                            <strong>Previous Date</strong>
                            <small>Select specific dates from calendar</small>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Calendar Selection Modal -->
    <div id="calendarSelectionModal" class="modal">
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h3>Select Work Dates to Pay</h3>
                <button class="close-modal" id="closeCalendarSelectionModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="calendar-selection-info">
                    <p>Select the work dates you want to include in this payment:</p>
                    <div class="payment-summary-preview">
                        <span>Selected: <span id="selectedDatesCount">0</span> days</span>
                        <span>Total: <span id="selectedAmountPreview">₹0</span></span>
                    </div>
                </div>
                <div class="unpaid-work-calendar" id="unpaidWorkCalendar">
                    <!-- Calendar with unpaid work dates will be generated here -->
                </div>
                <div class="calendar-actions">
                    <button id="proceedToPaymentBtn" class="btn btn-success" disabled>
                        <i class="fas fa-arrow-right"></i>
                        Proceed to Payment
                    </button>
                    <button id="cancelCalendarSelectionBtn" class="btn btn-secondary">
                        <i class="fas fa-times"></i>
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Payment Selection Modal -->
    <div id="paymentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Select Payment Amount</h3>
                <button class="close-modal" id="closePaymentModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="payment-info">
                    <p>You have <span id="unpaidDaysCount">4</span> unpaid work days.</p>
                    <p>Pending amount: <span id="pendingAmount">₹100</span></p>
                </div>
                <div class="payment-options">
                    <h4>Select payment amount:</h4>
                    
                    <!-- Quick Amount Buttons (Dynamically Generated) -->
                    <div class="payment-section">
                        <h5>Quick Amounts:</h5>
                        <div class="payment-buttons" id="paymentButtons">
                            <!-- Buttons will be generated dynamically based on increment value -->
                        </div>
                    </div>

                    <!-- Payment Summary -->
                    <div class="payment-summary" id="paymentSummary" style="display: none;">
                        <h5><i class="fas fa-receipt"></i> Payment Summary</h5>
                        <div class="summary-item">
                            <span>Selected Amount:</span>
                            <span id="selectedAmountDisplay">₹0</span>
                        </div>
                        <div class="summary-item">
                            <span>Payment Type:</span>
                            <span id="paymentTypeDisplay">Regular</span>
                        </div>
                        <div class="summary-item">
                            <span>Work Days Covered:</span>
                            <span id="workDaysCoveredDisplay">0</span>
                        </div>
                        
                        <!-- Confirmation Buttons -->
                        <div class="payment-confirmation-buttons">
                            <button id="confirmPaymentBtn" class="btn btn-primary">
                                <i class="fas fa-check"></i> Confirm Payment
                            </button>
                            <button id="cancelPaymentBtn" class="btn btn-secondary">
                                <i class="fas fa-times"></i> Cancel
                            </button>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- Earnings Insight Tooltip -->
    <div id="earningsInsightTooltip" class="earnings-tooltip">
        <div class="tooltip-content">
            <span id="earningsStatusMessage">Welcome to R-Service Tracker! Start working to begin tracking your earnings.</span>
        </div>
        <div class="tooltip-arrow"></div>
    </div>

    <!-- PWA Install Recommendation -->
    <div id="pwaInstallBanner" class="pwa-install-banner" style="display: none;">
        <div class="install-banner-content">
            <div class="install-banner-icon">
                <i class="fas fa-mobile-alt"></i>
            </div>
            <div class="install-banner-text">
                <h4>Install R-Service Tracker</h4>
                <p>Get quick access with shortcuts and offline functionality</p>
            </div>
            <div class="install-banner-actions">
                <button id="installAppBtn" class="btn btn-primary install-btn">
                    <i class="fas fa-download"></i> Install App
                </button>
                <button id="dismissInstallBtn" class="btn btn-secondary dismiss-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Audio Elements (now handled by Web Audio API in notifications.js) -->

    <!-- Scripts (optimized loading order) -->
    <script src="js/database.js" defer></script>
    <script src="js/utils.js" defer></script>
    <script src="js/notifications.js" defer></script>
    <script src="js/charts.js" defer></script>
    <script src="js/calendar.js" defer></script>
    <script src="js/app.js" defer></script>
</body>
</html>
